// Copyright (c) 2013-present, Iván Zaera Avellón - izaera@gmail.com

// This library is dually licensed under LGPL 3 and MPL 2.0. See file LICENSE for more information.

// This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0. If a copy of
// the MPL was not distributed with this file, you can obtain one at http://mozilla.org/MPL/2.0/.

library cipher.test.asymmetric.rsa_test;

import "package:bignum/bignum.dart";

import "package:cipher/cipher.dart";

import '../test/asymmetric_block_cipher_tests.dart';

void main() {

  initCipher();

  var modulus = new BigInteger(
      "20620915813302906913761247666337410938401372343750709187749515126790853245302593205328533062"
          "1543155272820561754551938120461341399358302220322577508666534616775667205087525445062665"
          "3394372597034549174796465448940593614555912137366462035270180157486330908793286530420556"
          "1439525871868738640172656811470047745445089832193075388387376667722031640892525639171016"
          "2970983952458876093598826939216433967246935235830765822089707945455811649524275775060359"
          "5112266915831309577959666600859174556200878712916030231324432998824079594846170161522806"
          "2848622019620094307696506764461083870202605984497833670577046553861732258592935325691");
  var publicExponent = new BigInteger("65537");
  var privateExponent = new BigInteger(
      "11998058528661160053642124235359844880039079149364512302169225182946866898849176558365314596"
          "7326603244933299675367723643276803488721344893195302280551021529927975675792262695441194"
          "3592691393718379375518238865053370091860262777088635890091437047244591150252614583792310"
          "4029967812779021649252540542517598618021899291933220000807916271555680217608559770825469"
          "2189848180607755622598200096373706963968898123179918804251277728011876641910595062585179"
          "5431390336236121148580228863594790360473830110103882379059929574957865583419541688634556"
          "9976295245464597506584866355976650830539380175531900288933412328525689718517239330305");
  var p = new BigInteger(
      "14417368284281758700219617206626454913837506807835923138294690689841279245263272659727952022"
          "9873489736777248181678202636100459215718497240474064366927544074501134727745837254834206"
          "4564005087191346108478142272749922982389733751464733501573042853464249822809278483396015"
          "14720098577525635486320547905945936448443");
  var q = new BigInteger(
      "14302829342151465465935854921497192158453409693835209632045881895641489093436548337529320204"
          "5679474764569937266017713262196941957149321696805368542065644090886347646782188634885321"
          "2775331756678402854485106878540614248679039686332180730604684344697611493352550074640912"
          "58725753837522484082998329871306803923137");

  /*
   * dP = 688057170495263083245752731085731160016625265771524738691797062279575950919479651156310413
   *      084174304361991240273181430924411258203766946639349880404106504114953688890200429043051936
   *      362182997575167191584461538746041795019663740246921124383173799957296515067912829778249931
   *      47390378095874103264534184571632120755
   * dQ = 507845703635907352171029104205623787367763009560317573489338345837584038336006347276053650
   *      854168084863747568576564717275939215915111267815838522662597851289336605236831336425802436
   *      200649556401825448584287304326412462681557799425513001833636033097539091662936055005478369
   *      55434209670082619152099365325073276033
   * Qinv = 5523068555971042766264141912739174368849856289970499395140501780334759026383323504097515
   *      890654733799249250196182032307613729339960097862069895553762714082909217637625041383714579
   *      842271623764719557507657884523476470037269187227172498294954194161376632496975538299347811
   *      6416238708238612702107474463263158193372
   */

  runAsymmetricBlockCipherTests("RSA", {
    Param.PublicKey: new RSAPublicKey(modulus, publicExponent)
  }, {
    Param.PrivateKey: new RSAPrivateKey(modulus, privateExponent, p, q)
  },
      [
          "Lorem ipsum dolor sit amet, consectetur adipiscing elit...",
          "3440ad17295687b43a3c81d7955351991c5f2f71a6a0b89571d8363c1dc825e219ea9aa0b668208e2d1c506f"
              "23ebc80536aed8577a146213b3cc9989bd3a758d1d1ca8a05cea9261d7df1642e930bc3976cb0b4df9e9"
              "423cbbe790fd51a32204230370092fc481efa2d364248febd940d999a4914856be080702845155711e2a"
              "7a4a0fecf5c4086792c1b1c4504a094713b7d7488c260265f45bbc80b601daf1de94ac57fd28bb5e1541"
              "54fb65b339cb88ec583aeb2621ef9f4c9f1f18111401e4c9d73f90194b6791ed06d254da971bc29954c8"
              "3d0752b2af4777f0c960a06bbb8d68b1f7d0efde31e634b679be598fbbec9f605f7484f773350c383267"
              "5b61",
          "0fe986b1829134af1ac8568f71f23f82a77263aabdc274ef3e2aa10e217f935f5fb4b139bcb01b13f7f687d0"
              "b1d84d26dd5e0106dd47e071e0b820902ea89946323c96342443054c5a5abccd2ad02cccf4740bf970e1"
              "44598c57f9575394eb24fbbf985eecfb357053cd53534cd4f183675e55f891de2b531881aba5c8149148"
              "74bb9cacdfccff650d0b57ca7c7ce6ff9b88d7848eff97da013c100bd926803e86d4cacf19065a2415ed"
              "d0bcba629a8edc99f4944ba244cfe491349eb43f23ae4363417aa73a7525f90dd80b787fe63d9b92c057"
              "ce5addd2a63635acb3ea6099afc0668a16682f31c997029b3e9aa2ef453b3f614dfb3c0e9e78ab453624"
              "99eb",
          "En un lugar de La Mancha, de cuyo nombre no quiero acordarme...",
          "6cf9c2b31c3a26dd7a3af82f49583f071f3a3693266dcf19128af9e14d875bc5fb0d224d953e6a1d9c9e38cd"
              "1782a147be51496d7476e31ec679290b4e37bc99508029d65ffcbe0d034febbf4b3e31895a054f99728c"
              "9c83de1fbdbc06f141077721dff132fda3eb36086301931665b503fd2a41294160815f9aa7af5da451f6"
              "f98572c69cc3fd29e66bee29cdbc05f562295a53c6a4fc439c18106cbb2ceef95d868e2da16de9f843c6"
              "5df26aff4c9bc6b7d59ed1a8d18a16d6c0abce4a5cfe792c921a99725bd5723fc4cfb37e732ed4f00525"
              "b79d192370e0584b2a8c5073a088dfde91c9e115f995611eeac6e7dfa63b38a8f964c96f0b57231b98ea"
              "d441",
          "7d7a3f179d37875f0f14b97cd9c0f266cc0087dbb674488981c1669ec57da4b4025967c6f8557789bf79009c"
              "e5f7c15483a887964fc19fd444657538d477368b3681b40de94cc70d3f2dd3d075c7b37b29afb8300b7c"
              "e1219c8a9acede902b70f23697d047b13cb37ba95b909a3e30c162591afd5857543555bb73164d5711ad"
              "135f997bb0df8c21cb8bf2cfff3f67b145483d3c3e2fee78e600e5c14cdf73cd2ecb63afaee65006644f"
              "7b6dab026624c11f142a8ec393c9e409a56da9ddfcbe6d35f8f01533d5a30db3a55c8510bb457c8e3a85"
              "e17133c2231be209eb8fa0c93fb87ba7ca2edd30bb4485bf1cb923522414d3d6b0e6d25c251e45e08505"
              "a966"]);

}
